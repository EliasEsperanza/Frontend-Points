<<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/RamitaPrincipal/estilos/navbar.css" />
    <link rel="stylesheet" href="/Perfil_Usuario/estilos/style.css" />
    <link rel="stylesheet" href="/RamitaPrincipal/estilos/footer.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <script src="/RamitaPrincipal/js/navbar.js" defer></script>
    <title>Perfil de usuario</title>
  </head>
  <body>
    <!--Parte del navbar-->
    <header>
        <div class="logo-container">
            <img src="/Perfil_Usuario/Logo.jpg" class="imgLogo" alt="">
            <a href="#" class="Nombre">Ferreteria El Roble</a>
        </div>
        <ul class="links">
            <li><a href="/Inicio/html/index.html">Inicio</a></li>
                <li><a href="#" id="logout">cerrar Sesion</a></li>
                <li><a href="/Perfil_Usuario/html/index.html">Perfil</a></li>
                <li><a href="/RamitaPrincipal/HTML/premios.html">Premios</a></li>
                <li><a href="/RamitaPrincipal/HTML/puntos.html">Puntos</a></li>
                <li><a href="/RamitaPrincipal/HTML/beneficios.html">Beneficios</a></li>
        </ul>
        <div class="toggle_btn"><i class="fa-solid fa-bars"></i></div>
        <div class="close_btn"><i class="fa-solid fa-x"></i></div>
    </header>

    <main>
      <!--Contenido del perfil de usuario-->
      <div class="Contenido">
        <div class="Content-perfil">
          <div class="img-perfil">
            <img src="/Perfil_Usuario/perfil.jpg" alt="" />
          </div>

          <div class="titulo">
            <h1>Bienvenido a tu perfil de usuario</h1>
          </div>

          <div class="Textos">
            <div class="name">
              <p>Tu nombre de usuario:</p>
              <p class="txt-estl name"></p>
              <!-- Añadí la clase name -->
            </div>

            <div class="email">
              <p>Tu email:</p>
              <p class="txt-estl email"></p>
              <!-- Añadí la clase email -->
            </div>
            <div class="password">
              <p>Tu password:</p>
              <p class="txt-estl password"></p>
              <!-- Añadí la clase password -->
            </div>

            <div class="dui">
              <p>Tu DUI:</p>
              <p class="txt-estl dui"></p>
              <!-- Añadí la clase dui -->
            </div>

            <div class="nit">
              <p>Tu NIT:</p>
              <p class="txt-estl nit"></p>
              <!-- Añadí la clase nit -->
            </div>

            <div class="nrc">
              <p>Tu nrc:</p>
              <p class="txt-estl nrc"></p>
              <!-- Añadí la clase nrc -->
            </div>

            <div class="tel">
              <p>Tu numero de telefono:</p>
              <p class="txt-estl tel"></p>
              <!-- Añadí la clase tel -->
            </div>

            <div class="direccion">
              <p>Tu direccion:</p>
              <p class="txt-estl direccion"></p>
              <!-- Añadí la clase direccion -->
            </div>
          </div>

          <div class="botones">
            <div class="btn-agregar">
              <input type="submit" value="Agregar" />
            </div>

            <div class="btn-editar">
              <input type="submit" value="Editar" />
            </div>
          </div>
        </div>
      </div>
    </main>

    <!--Esta seria la parte del Footer-->
    <footer>
      <div class="row">
        <div class="col">
          <img src="/Inicio/Logo.jpg" class="logo" />
          <p>
            Lorem ipsum dolor sit amet consectetur adipisicing elit. Quidem
            rerum vel ipsa mollitia reprehenderit velit! Aspernatur quibusdam
            exercitationem delectus iure id cum laboriosam aliquid eveniet!
            Architecto laborum optio voluptate temporibus.
          </p>
        </div>
        <div class="col">
          <h3>
            Contactos
            <div class="underline"><span></span></div>
          </h3>
          <p>Tel: 4555555</p>
          <p>Correo: nose@gmail.com</p>
          <p class="email-id">direccion: nose tampoco</p>
          <p>mas datos para poner</p>
          <p>quiero dormir</p>
        </div>
        <div class="col">
          <h3>
            Links
            <div class="underline"><span></span></div>
          </h3>
          <ul>
            <li>Inicio</li>
            <li>Iniciar Sesion</li>
            <li>Politicas</li>
            <li>Beneficios</li>
            <li>NOSE</li>
            <li>NOSEX2</li>
          </ul>
        </div>
        <div class="col">
          <h3>
            Comentarios
            <div class="underline"><span></span></div>
          </h3>
          <form>
            <i class="fa-regular fa-envelope"></i>
            <input type="email" placeholder="Escriba su comentario" required />
            <button type="submit">
              <i class="fa-solid fa-arrow-right"></i>
            </button>
          </form>
          <div class="social-icons">
            <i class="fa-brands fa-facebook"></i>
            <i class="fa-brands fa-twitter"></i>
            <i class="fa-brands fa-whatsapp"></i>
          </div>
        </div>
      </div>
      <hr />
      <p class="copyright">
        Universidad de El salvador © 2024 - ALL Rights Reserved
      </p>
    </footer>
    <!--APIS-->
    <script>
      document.addEventListener("DOMContentLoaded", async () => {
        const idCliente = localStorage.getItem("idCliente");
        console.log("idCliente:", idCliente);

        const idUsuario = localStorage.getItem("idUsuario");
        console.log("idUsuario:", idUsuario);

        if (idCliente) {
          try {
            const token = localStorage.getItem("jwt");
            if (!token) {
              console.error("No token found, redirecting to login...");
              window.location.href = "/Login/index.html";
              return;
            }

            const response = await fetch(
              `https://backend-points-production.up.railway.app/cliente/${idCliente}`,
              {
                method: "GET",
                headers: {
                  Authorization: `Bearer ${token}`,
                  "Content-Type": "application/json",
                },
              }
            );


            if (!response.ok) {
              throw new Error("Failed to fetch user data");
            }

            const data = await response.json();
            console.log(data);

            populateUserProfile(data.data);
          } catch (error) {
            console.error("Error:", error);
          }
        }
      });

      function populateUserProfile(user) {
        document.querySelector(".txt-estl.name").textContent =
          user.nombreCliente;
        document.querySelector(".txt-estl.email").textContent = user.correo;
        document.querySelector(".txt-estl.password").textContent =
          user.passwordHash;
        document.querySelector(".txt-estl.dui").textContent = user.dui;
        document.querySelector(".txt-estl.nit").textContent = user.nit;
        document.querySelector(".txt-estl.nrc").textContent = user.nrc;
        document.querySelector(".txt-estl.tel").textContent = user.telefono;
        document.querySelector(".txt-estl.direccion").textContent =
          user.direccion;
      }
    </script>
    <script src="/Login/log_out.js" defer></script>
  </body>
</html>
